if(jQuery)(function(e){function t(t,n){var r=e('<span class="minicolors" />'),i=e.minicolors.defaultSettings;if(t.data("minicolors-initialized"))return;n=e.extend(true,{},i,n);r.addClass("minicolors-theme-"+n.theme).addClass("minicolors-swatch-position-"+n.swatchPosition).toggleClass("minicolors-swatch-left",n.swatchPosition==="left").toggleClass("minicolors-with-opacity",n.opacity);if(n.position!==undefined){e.each(n.position.split(" "),function(){r.addClass("minicolors-position-"+this)})}t.addClass("minicolors-input").data("minicolors-initialized",true).data("minicolors-settings",n).prop("size",7).prop("maxlength",7).wrap(r).after('<span class="minicolors-panel minicolors-slider-'+n.control+'">'+'<span class="minicolors-slider">'+'<span class="minicolors-picker"></span>'+"</span>"+'<span class="minicolors-opacity-slider">'+'<span class="minicolors-picker"></span>'+"</span>"+'<span class="minicolors-grid">'+'<span class="minicolors-grid-inner"></span>'+'<span class="minicolors-picker"><span></span></span>'+"</span>"+"</span>");t.parent().find(".minicolors-panel").on("selectstart",function(){return false}).end();if(n.swatchPosition==="left"){t.before('<span class="minicolors-swatch"><span></span></span>')}else{t.after('<span class="minicolors-swatch"><span></span></span>')}if(!n.textfield)t.addClass("minicolors-hidden");if(n.inline)t.parent().addClass("minicolors-inline");a(t)}function n(e){var t=e.parent();e.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeProp("maxlength").removeClass("minicolors-input");t.before(e).remove()}function r(e){a(e)}function i(e){var t=e.parent(),n=t.find(".minicolors-panel"),r=e.data("minicolors-settings");if(!e.data("minicolors-initialized")||e.prop("disabled")||t.hasClass("minicolors-focus"))return;s();t.addClass("minicolors-focus");n.stop(true,true).fadeIn(r.showSpeed,function(){if(r.show)r.show.call(e)})}function s(){e(".minicolors-input").each(function(){var t=e(this),n=t.data("minicolors-settings"),r=t.parent();if(n.inline)return;r.find(".minicolors-panel").fadeOut(n.hideSpeed,function(){if(r.hasClass("minicolors-focus")){if(n.hide)n.hide.call(t)}r.removeClass("minicolors-focus")})})}function o(e,t,n){var r=e.parents(".minicolors").find(".minicolors-input"),i=r.data("minicolors-settings"),s=e.find("[class$=-picker]"),o=e.offset().left,a=e.offset().top,f=Math.round(t.pageX-o),l=Math.round(t.pageY-a),c=n?i.animationSpeed:0,h,p,d,v;if(t.originalEvent.changedTouches){f=t.originalEvent.changedTouches[0].pageX-o;l=t.originalEvent.changedTouches[0].pageY-a}if(f<0)f=0;if(l<0)l=0;if(f>e.width())f=e.width();if(l>e.height())l=e.height();if(e.parent().is(".minicolors-slider-wheel")&&s.parent().is(".minicolors-grid")){h=75-f;p=75-l;d=Math.sqrt(h*h+p*p);v=Math.atan2(p,h);if(v<0)v+=Math.PI*2;if(d>75){d=75;f=75-75*Math.cos(v);l=75-75*Math.sin(v)}f=Math.round(f);l=Math.round(l)}if(e.is(".minicolors-grid")){s.stop(true).animate({top:l+"px",left:f+"px"},c,i.animationEasing,function(){u(r)})}else{s.stop(true).animate({top:l+"px"},c,i.animationEasing,function(){u(r)})}}function u(e){function t(e,t){var n,r;if(!e.length||!t)return null;n=e.offset().left;r=e.offset().top;return{x:n-t.offset().left+e.outerWidth()/2,y:r-t.offset().top+e.outerHeight()/2}}var n,r,i,s,o,u,a,f,l,h,d=e.parent(),v=e.data("minicolors-settings"),g=d.find(".minicolors-panel"),y=d.find(".minicolors-swatch"),b=d.find(".minicolors-grid"),w=d.find(".minicolors-slider"),E=d.find(".minicolors-opacity-slider"),S=b.find("[class$=-picker]"),x=w.find("[class$=-picker]"),T=E.find("[class$=-picker]"),N=t(S,b),C=t(x,w),k=t(T,E);switch(v.control){case"wheel":a=b.width()/2-N.x;f=b.height()/2-N.y;l=Math.sqrt(a*a+f*f);h=Math.atan2(f,a);if(h<0)h+=Math.PI*2;if(l>75){l=75;N.x=69-75*Math.cos(h);N.y=69-75*Math.sin(h)}r=p(l/.75,0,100);n=p(h*180/Math.PI,0,360);i=p(100-Math.floor(C.y*(100/w.height())),0,100);u=m({h:n,s:r,b:i});w.css("backgroundColor",m({h:n,s:r,b:100}));break;case"saturation":n=p(parseInt(N.x*(360/b.width())),0,360);r=p(100-Math.floor(C.y*(100/w.height())),0,100);i=p(100-Math.floor(N.y*(100/b.height())),0,100);u=m({h:n,s:r,b:i});w.css("backgroundColor",m({h:n,s:100,b:i}));d.find(".minicolors-grid-inner").css("opacity",r/100);break;case"brightness":n=p(parseInt(N.x*(360/b.width())),0,360);r=p(100-Math.floor(N.y*(100/b.height())),0,100);i=p(100-Math.floor(C.y*(100/w.height())),0,100);u=m({h:n,s:r,b:i});w.css("backgroundColor",m({h:n,s:r,b:100}));d.find(".minicolors-grid-inner").css("opacity",1-i/100);break;default:n=p(360-parseInt(C.y*(360/w.height())),0,360);r=p(Math.floor(N.x*(100/b.width())),0,100);i=p(100-Math.floor(N.y*(100/b.height())),0,100);u=m({h:n,s:r,b:i});b.css("backgroundColor",m({h:n,s:100,b:100}));break}if(v.opacity){s=parseFloat(1-k.y/E.height()).toFixed(2)}else{s=1}e.val(c(u,v.letterCase));if(v.opacity)e.attr("data-opacity",s);y.find("SPAN").css({backgroundColor:u,opacity:s});if(u+s!==e.data("minicolors-lastChange")){e.data("minicolors-lastChange",u+s);if(v.change)v.change.call(e,u,s)}}function a(e,t){var n,r,i,s,o,u,a,f=e.parent(),l=e.data("minicolors-settings"),d=f.find(".minicolors-swatch"),v=f.find(".minicolors-grid"),y=f.find(".minicolors-slider"),b=f.find(".minicolors-opacity-slider"),w=v.find("[class$=-picker]"),E=y.find("[class$=-picker]"),S=b.find("[class$=-picker]");n=c(h(e.val(),true),l.letterCase);if(!n)n=c(h(l.defaultValue,true));r=g(n);if(!t)e.val(n);if(l.opacity){i=e.attr("data-opacity")===""?1:p(parseFloat(e.attr("data-opacity")).toFixed(2),0,1);e.attr("data-opacity",i);d.find("SPAN").css("opacity",i);o=p(b.height()-b.height()*i,0,b.height());S.css("top",o+"px")}d.find("SPAN").css("backgroundColor",n);switch(l.control){case"wheel":u=p(Math.ceil(r.s*.75),0,v.height()/2);a=r.h*Math.PI/180;s=p(75-Math.cos(a)*u,0,v.width());o=p(75-Math.sin(a)*u,0,v.height());w.css({top:o+"px",left:s+"px"});o=150-r.b/(100/v.height());if(n==="")o=0;E.css("top",o+"px");y.css("backgroundColor",m({h:r.h,s:r.s,b:100}));break;case"saturation":s=p(5*r.h/12,0,150);o=p(v.height()-Math.ceil(r.b/(100/v.height())),0,v.height());w.css({top:o+"px",left:s+"px"});o=p(y.height()-r.s*(y.height()/100),0,y.height());E.css("top",o+"px");y.css("backgroundColor",m({h:r.h,s:100,b:r.b}));f.find(".minicolors-grid-inner").css("opacity",r.s/100);break;case"brightness":s=p(5*r.h/12,0,150);o=p(v.height()-Math.ceil(r.s/(100/v.height())),0,v.height());w.css({top:o+"px",left:s+"px"});o=p(y.height()-r.b*(y.height()/100),0,y.height());E.css("top",o+"px");y.css("backgroundColor",m({h:r.h,s:r.s,b:100}));f.find(".minicolors-grid-inner").css("opacity",1-r.b/100);break;default:s=p(Math.ceil(r.s/(100/v.width())),0,v.width());o=p(v.height()-Math.ceil(r.b/(100/v.height())),0,v.height());w.css({top:o+"px",left:s+"px"});o=p(y.height()-r.h/(360/y.height()),0,y.height());E.css("top",o+"px");v.css("backgroundColor",m({h:r.h,s:100,b:100}));break}}function f(t){var n=h(e(t).val(),true),r=b(n),i=e(t).attr("data-opacity");if(!r)return null;if(i!==undefined)e.extend(r,{a:parseFloat(i)});return r}function l(t,n){var r=h(e(t).val(),true),i=b(r),s=e(t).attr("data-opacity");if(!i)return null;if(s===undefined)s=1;if(n){return"rgba("+i.r+", "+i.g+", "+i.b+", "+parseFloat(s)+")"}else{return"rgb("+i.r+", "+i.g+", "+i.b+")"}}function c(e,t){return t==="uppercase"?e.toUpperCase():e.toLowerCase()}function h(e,t){e=e.replace(/[^A-F0-9]/ig,"");if(e.length!==3&&e.length!==6)return"";if(e.length===3&&t){e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]}return"#"+e}function p(e,t,n){if(e<t)e=t;if(e>n)e=n;return e}function d(e){var t={};var n=Math.round(e.h);var r=Math.round(e.s*255/100);var i=Math.round(e.b*255/100);if(r===0){t.r=t.g=t.b=i}else{var s=i;var o=(255-r)*i/255;var u=(s-o)*(n%60)/60;if(n===360)n=0;if(n<60){t.r=s;t.b=o;t.g=o+u}else if(n<120){t.g=s;t.b=o;t.r=s-u}else if(n<180){t.g=s;t.r=o;t.b=o+u}else if(n<240){t.b=s;t.r=o;t.g=s-u}else if(n<300){t.b=s;t.g=o;t.r=o+u}else if(n<360){t.r=s;t.g=o;t.b=s-u}else{t.r=0;t.g=0;t.b=0}}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}}function v(t){var n=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];e.each(n,function(e,t){if(t.length===1)n[e]="0"+t});return"#"+n.join("")}function m(e){return v(d(e))}function g(e){var t=y(b(e));if(t.s===0)t.h=360;return t}function y(e){var t={h:0,s:0,b:0};var n=Math.min(e.r,e.g,e.b);var r=Math.max(e.r,e.g,e.b);var i=r-n;t.b=r;t.s=r!==0?255*i/r:0;if(t.s!==0){if(e.r===r){t.h=(e.g-e.b)/i}else if(e.g===r){t.h=2+(e.b-e.r)/i}else{t.h=4+(e.r-e.g)/i}}else{t.h=-1}t.h*=60;if(t.h<0){t.h+=360}t.s*=100/255;t.b*=100/255;return t}function b(e){e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:e>>16,g:(e&65280)>>8,b:e&255}}e.minicolors={defaultSettings:{animationSpeed:100,animationEasing:"swing",change:null,control:"hue",defaultValue:"",hide:null,hideSpeed:100,inline:false,letterCase:"lowercase",opacity:false,position:"default",show:null,showSpeed:100,swatchPosition:"left",textfield:true,theme:"default"}};e.extend(e.fn,{minicolors:function(i,s){switch(i){case"destroy":e(this).each(function(){n(e(this))});return e(this);case"opacity":if(s===undefined){return e(this).attr("data-opacity")}else{e(this).each(function(){r(e(this).attr("data-opacity",s))});return e(this)};case"rgbObject":return f(e(this),i==="rgbaObject");case"rgbString":case"rgbaString":return l(e(this),i==="rgbaString");case"settings":if(s===undefined){return e(this).data("minicolors-settings")}else{e(this).each(function(){var t=e(this).data("minicolors-settings")||{};n(e(this));e(this).minicolors(e.extend(true,t,s))});return e(this)};case"value":if(s===undefined){return e(this).val()}else{e(this).each(function(){r(e(this).val(s))});return e(this)};case"create":default:if(i!=="create")s=i;e(this).each(function(){t(e(this),s)});return e(this)}}});e(document).on("mousedown.minicolors touchstart.minicolors",function(t){if(!e(t.target).parents().add(t.target).hasClass("minicolors")){s()}}).on("mousedown.minicolors touchstart.minicolors",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(t){var n=e(this);t.preventDefault();e(document).data("minicolors-target",n);o(n,t,true)}).on("mousemove.minicolors touchmove.minicolors",function(t){var n=e(document).data("minicolors-target");if(n)o(n,t)}).on("mouseup.minicolors touchend.minicolors",function(){e(this).removeData("minicolors-target")}).on("mousedown.minicolors touchstart.minicolors",".minicolors-swatch",function(t){var n=e(this).parent().find(".minicolors-input"),r=n.parent();if(r.hasClass("minicolors-focus")){s(n)}else{i(n)}}).on("focus.minicolors",".minicolors-input",function(t){var n=e(this);if(!n.data("minicolors-initialized"))return;i(n)}).on("blur.minicolors",".minicolors-input",function(t){var n=e(this),r=n.data("minicolors-settings");if(!n.data("minicolors-initialized"))return;n.val(h(n.val(),true));if(n.val()==="")n.val(h(r.defaultValue,true));n.val(c(n.val(),r.letterCase));s(n)}).on("keydown.minicolors",".minicolors-input",function(t){var n=e(this);if(!n.data("minicolors-initialized"))return;switch(t.keyCode){case 9:s();break;case 27:s();n.blur();break}}).on("keyup.minicolors",".minicolors-input",function(t){var n=e(this);if(!n.data("minicolors-initialized"))return;a(n,true)}).on("paste.minicolors",".minicolors-input",function(t){var n=e(this);if(!n.data("minicolors-initialized"))return;setTimeout(function(){a(n,true)},1)})})(jQuery)